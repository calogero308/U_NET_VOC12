import matplotlib.pyplot as plt

"""
-> Train CE/DL in blu → come il modello sta imparando
-> Validation CE/DL in arancione → come generalizza
-> Eventuali plateau o leggeri aumenti di validation loss sono facilmente visibili
"""

# Dati delle 50 epoche
epoche = list(range(1, 51))

# Train loss totale, CE e Dice
train_loss_total = [
    1.9402,1.7221,1.6975,1.7083,1.6836,1.6879,1.6690,1.6752,1.6739,1.6542,
    1.6458,1.6208,1.6232,1.5965,1.6010,1.5614,1.5388,1.5190,1.4923,1.4831,
    1.4668,1.4490,1.4280,1.4160,1.4115,1.3929,1.3716,1.3510,1.3552,1.3225,
    1.3112,1.2972,1.2890,1.2794,1.2542,1.2481,1.2442,1.2412,1.2192,1.1988,
    1.1747,1.1803,1.1553,1.1251,1.1357,1.1167,1.1083,1.0856,1.0766,1.0704
]
train_loss_ce = [
    1.6718,1.4849,1.4639,1.4728,1.4511,1.4553,1.4387,1.4444,1.4420,1.4248,
    1.4164,1.3945,1.3960,1.3725,1.3749,1.3386,1.3179,1.2994,1.2753,1.2658,
    1.2512,1.2353,1.2161,1.2056,1.2005,1.1843,1.1648,1.1474,1.1500,1.1213,
    1.1112,1.0990,1.0916,1.0830,1.0609,1.0559,1.0522,1.0500,1.0298,1.0125,
    0.9911,0.9961,0.9735,0.9475,0.9568,0.9404,0.9329,0.9131,0.9056,0.8992
]
train_loss_dice = [
    0.5369,0.4744,0.4671,0.4711,0.4650,0.4653,0.4606,0.4617,0.4638,0.4588,
    0.4589,0.4526,0.4544,0.4480,0.4522,0.4455,0.4419,0.4393,0.4341,0.4347,
    0.4310,0.4274,0.4239,0.4208,0.4219,0.4172,0.4135,0.4071,0.4103,0.4025,
    0.3999,0.3963,0.3948,0.3928,0.3866,0.3843,0.3840,0.3823,0.3789,0.3726,
    0.3672,0.3684,0.3636,0.3551,0.3578,0.3525,0.3507,0.3450,0.3420,0.3423
]

# Validation loss totale, CE e Dice
val_loss_total = [
    1.5158,1.4411,1.4416,1.4257,1.4185,1.4238,1.4103,1.4134,1.3967,1.4250,
    1.3813,1.3758,1.3702,1.3989,1.3327,1.3258,1.3040,1.3458,1.2900,1.3266,
    1.2419,1.2401,1.2349,1.2838,1.2092,1.2795,1.1883,1.2411,1.1951,1.1622,
    1.1437,1.1748,1.1741,1.1465,1.1550,1.0894,1.1320,1.1582,1.0974,1.0736,
    1.0706,1.1111,1.0568,1.0596,1.0379,1.0590,1.0660,1.0564,1.1141,1.0555
]
val_loss_ce = [
    1.2770,1.2330,1.2347,1.2218,1.2303,1.2137,1.2153,1.2022,1.1989,1.2025,
    1.1781,1.1748,1.1859,1.1772,1.1363,1.1388,1.1104,1.1219,1.1137,1.1353,
    1.0481,1.0616,1.0634,1.0929,1.0333,1.0675,1.0046,1.0446,0.9985,0.9906,
    0.9769,0.9796,0.9864,0.9697,0.9743,0.9262,0.9662,1.1219,0.9286,0.9057,
    0.9093,0.9236,0.8958,0.8976,0.8775,0.8991,0.8927,0.8886,0.9394,0.2969
]
val_loss_dice = [
    0.4775,0.4163,0.4137,0.4077,0.3763,0.4201,0.3900,0.4225,0.3956,0.4451,
    0.4065,0.4021,0.3687,0.4435,0.3928,0.3740,0.3871,0.4478,0.3525,0.3828,
    0.3876,0.3570,0.3430,0.3819,0.3517,0.4242,0.3673,0.3930,0.3931,0.3431,
    0.3336,0.3905,0.3754,0.3537,0.3613,0.3264,0.3316,0.3882,0.3375,0.3357,
    0.3227,0.3752,0.3220,0.3240,0.3209,0.3198,0.3467,0.3357,0.3493,0.2969
]

# Plot
plt.figure(figsize=(16,6))

# Train vs Val Loss Totale
plt.plot(epoche, train_loss_total, label="Train Loss Totale", color="blue")
plt.plot(epoche, val_loss_total, label="Validation Loss Totale", color="orange")

# Train vs Val CE
plt.plot(epoche, train_loss_ce, label="Train CE Loss", color="green", linestyle="--")
plt.plot(epoche, val_loss_ce, label="Val CE Loss", color="red", linestyle="--")

# Train vs Val Dice
plt.plot(epoche, train_loss_dice, label="Train Dice Loss", color="purple", linestyle=":")
plt.plot(epoche, val_loss_dice, label="Val Dice Loss", color="brown", linestyle=":")

plt.xlabel("Epoche")
plt.ylabel("Loss")
plt.title("Training vs Validation Loss - U-Net VOC2012")
plt.legend()
plt.grid(True)
plt.show()

